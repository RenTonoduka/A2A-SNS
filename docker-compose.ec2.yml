# =============================================================================
# A2A SNS System - EC2 Production Configuration
# =============================================================================
# Usage:
#   docker-compose -f docker-compose.yml -f docker-compose.ec2.yml up -d
# =============================================================================

version: '3.8'

services:
  # ========================================
  # SNS Orchestrator (EC2 Override)
  # ========================================
  sns-orchestrator:
    restart: unless-stopped
    volumes:
      - .:/app:ro  # Read-only for security
      - claude-auth:/root/.claude:ro
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"
    deploy:
      resources:
        limits:
          memory: 512M
        reservations:
          memory: 256M

  # ========================================
  # YouTube Agents (EC2 Override)
  # ========================================
  youtube-script-writer:
    restart: unless-stopped
    volumes:
      - .:/app:ro
      - claude-auth:/root/.claude:ro
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"
    deploy:
      resources:
        limits:
          memory: 512M
        reservations:
          memory: 256M

  youtube-shorts-creator:
    restart: unless-stopped
    volumes:
      - .:/app:ro
      - claude-auth:/root/.claude:ro
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"
    deploy:
      resources:
        limits:
          memory: 512M
        reservations:
          memory: 256M

  youtube-seo-optimizer:
    restart: unless-stopped
    volumes:
      - .:/app:ro
      - claude-auth:/root/.claude:ro
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"
    deploy:
      resources:
        limits:
          memory: 512M
        reservations:
          memory: 256M

  youtube-thumbnail-planner:
    restart: unless-stopped
    volumes:
      - .:/app:ro
      - claude-auth:/root/.claude:ro
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"
    deploy:
      resources:
        limits:
          memory: 512M
        reservations:
          memory: 256M

# ========================================
# Named Volumes for EC2
# ========================================
volumes:
  claude-auth:
    driver: local
    driver_opts:
      type: none
      o: bind
      device: ${HOME}/.claude
