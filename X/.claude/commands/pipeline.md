# /pipeline コマンド

抽出から分析、レポート生成までの一連のフローを自動実行

## 使用方法

```
/pipeline @username                    # 基本パイプライン
/pipeline @user1 @user2 --compare     # 比較パイプライン
/pipeline @username --full            # フル分析
```

## パイプライン概要

```
┌─────────────┐     ┌─────────────┐     ┌─────────────┐
│  セッション  │────▶│  ポスト抽出  │────▶│  基本分析   │
│    確認     │     │             │     │             │
└─────────────┘     └─────────────┘     └─────────────┘
                                               │
                    ┌─────────────┐            │
                    │  バズ分析   │◀───────────┘
                    │             │
                    └─────────────┘
                           │
                    ┌─────────────┐
                    │  レポート   │
                    │    生成     │
                    └─────────────┘
```

## 実行手順

### Phase 1: セッション確認

```bash
python session_manager.py verify
```

- ✅ 有効 → 次へ
- ❌ 無効 → ログイン案内して停止

### Phase 2: ポスト抽出

```bash
python post_extractor.py <username> --max 100
```

出力確認:
- 取得件数
- 保存ファイルパス

### Phase 3: 基本分析

抽出データを読み込み、以下を計算:
- エンゲージメント統計
- 投稿パターン
- トップポスト

### Phase 4: バズ分析

バズポストを特定し、要因分析:
- バズスコア計算
- パターン抽出
- 推奨アクション

### Phase 5: レポート生成

全分析結果を統合したレポートを生成:

```
data/reports/YYYYMMDD_@username_report.md
```

---

## 出力例

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📊 X Pipeline: @elonmusk
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

[Phase 1] Session Check
└─ ✅ セッション有効

[Phase 2] Extract
├─ ✅ 取得: 100件
├─ 期間: 2024-01-01 〜 2024-01-15
└─ 保存: data/x_posts_20240115_120000.json

[Phase 3] Basic Analysis
├─ 平均いいね: 45,000
├─ 平均RT: 8,500
├─ 平均リプライ: 12,000
└─ エンゲージ率: 2.3%

[Phase 4] Buzz Analysis
├─ バズポスト: 8件 (8%)
├─ 最大バズ: 850,000 いいね
└─ バズ要因: テック話題、夕方投稿

[Phase 5] Report
├─ 生成: data/reports/20240115_elonmusk_report.md
└─ インサイト: 3件

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ Pipeline Completed (2min 30sec)
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📋 サマリー:
@elonmusk は1日平均X件投稿し、テック関連の話題で
特に高いエンゲージメントを獲得。夕方18-21時の投稿が
最もバズりやすい傾向。
```

---

## オプション

| オプション | 説明 |
|-----------|------|
| `--max N` | 抽出件数 |
| `--compare` | 比較分析モード |
| `--full` | 全分析実行 |
| `--skip-extract` | 既存データ使用 |
| `--output dir` | 出力ディレクトリ |

---

## 比較パイプライン

```
/pipeline @user1 @user2 --compare
```

追加で比較分析を実行し、差異をレポート。

---

## エラー時の対応

### セッション無効
```
⚠️ セッションが無効です。
python session_manager.py login でログインしてください。
```

### 抽出エラー
```
⚠️ アカウントが見つかりません: @xxxxx
ユーザー名を確認してください。
```

---

## 入力例

```
/pipeline @naval --max 200 --full
```

## 関連コマンド

- `/extract` - 抽出のみ
- `/analyze` - 分析のみ
- `/buzz` - バズ分析のみ
- `/session` - セッション管理
